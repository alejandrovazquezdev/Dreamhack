{% extends 'base-template-user.html' %}

    
    {% block styles %}

    {% endblock %}

    
    {% block content %}
        
    <div class="app-container">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-avatar">
                    <i class="fa-solid fa-user"></i>
                </div>
                <span class="sidebar-username">{{ session.get('user_name', 'Usuario') }}</span>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="{{ url_for('dashboard') }}"><i class="icon fa-solid fa-house"></i> Inicio</a></li>
                    <li><a href="#" onclick="alert('Sección de Ayuda - Próximamente')"><i class="icon fa-solid fa-circle-question"></i> Ayuda</a></li>
                    <li><a href="{{ url_for('mis_salas') }}"><i class="icon fa-solid fa-comments"></i> Mis Salas</a></li> 
                    <li><a href="#" onclick="alert('Sección de Facturación - Próximamente')"><i class="icon fa-solid fa-file-invoice"></i> Facturación</a></li>
                    <li><a href="#" onclick="alert('Configuración - Próximamente')"><i class="icon fa-solid fa-gears"></i> Configuración</a></li>
                </ul>
            </nav>
            <footer class="sidebar-footer">
                <a href="{{ url_for('logout') }}">Cerrar sesión</a>
            </footer>
        </aside>

        <main class="main-content">
            
            <div class="content-card">
                <div class="content-card-header">
                    <h2>2. Comparte el link</h2>
                    <p class="content-card-subtitle">
                        <i class="fa-solid fa-diamond"></i>
                        Comparte el link o el código de chat con la persona que deseas negociar
                    </p>
                </div>

                <div class="content-card-body">
                    
                    <div class="share-item">
                        <label for="link-input">Link:</label>
                        <div class="share-input-wrapper">
                            <input type="text" id="link-input" value="{{ sala.get_link() }}" readonly>
                            <div class="share-actions">
                                <button class="btn-icon-share" onclick="copiarTexto('link-input')" aria-label="Copiar link">
                                    <i class="fa-solid fa-copy"></i>
                                </button>
                                <button class="btn-icon-share" onclick="compartirWhatsApp('link-input')" aria-label="Compartir en WhatsApp">
                                    <i class="fa-brands fa-whatsapp"></i>
                                </button>
                                <button class="btn-icon-share" onclick="compartirMessenger('link-input')" aria-label="Compartir en Messenger">
                                    <i class="fa-brands fa-facebook-messenger"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="share-item">
                        <label for="code-input">Código de chat:</label>
                        <div class="share-input-wrapper">
                            <input type="text" id="code-input" value="{{ sala.codigo }}" readonly>
                            <div class="share-actions">
                                <button class="btn-icon-share" onclick="copiarTexto('code-input')" aria-label="Copiar código">
                                    <i class="fa-solid fa-copy"></i>
                                </button>
                                <button class="btn-icon-share" onclick="compartirWhatsApp('code-input')" aria-label="Compartir en WhatsApp">
                                    <i class="fa-brands fa-whatsapp"></i>
                                </button>
                                <button class="btn-icon-share" onclick="compartirMessenger('code-input')" aria-label="Compartir en Messenger">
                                    <i class="fa-brands fa-facebook-messenger"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="content-card-footer">
                    <a href="{{ url_for('dashboard') }}" class="btn-text">Volver al inicio</a>
                    <a href="{{ url_for('mis_salas') }}" class="btn btn-secondary">Ver mis salas</a>
                </div>
            </div>

            <a href="#" onclick="alert('Contacta con soporte: soporte@shifting.com')" class="btn btn-primary floating-support-btn">
                <i class="fa-solid fa-headset"></i>
                Soporte
            </a>

        </main>
    </div>

    <script>
        // Función para copiar texto al portapapeles
        function copiarTexto(inputId) {
            const input = document.getElementById(inputId);
            input.select();
            input.setSelectionRange(0, 99999); // Para móviles
            
            navigator.clipboard.writeText(input.value).then(() => {
                alert('✓ Copiado al portapapeles');
            }).catch(err => {
                console.error('Error al copiar:', err);
            });
        }

        // Función para compartir en WhatsApp
        function compartirWhatsApp(inputId) {
            const input = document.getElementById(inputId);
            const texto = encodeURIComponent(`¡Únete a mi sala de negociación en Shifting! ${input.value}`);
            window.open(`https://wa.me/?text=${texto}`, '_blank');
        }

        // Función para compartir en Messenger
        function compartirMessenger(inputId) {
            const input = document.getElementById(inputId);
            const link = encodeURIComponent(input.value);
            window.open(`https://www.facebook.com/dialog/send?link=${link}&app_id=YOUR_APP_ID&redirect_uri=${window.location.href}`, '_blank');
        }
    </script>

{% endblock %}